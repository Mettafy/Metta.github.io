<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>NFSå­˜å‚¨ | DevOps</title><meta name="author" content="Metta"><meta name="copyright" content="Metta"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="ä¸€ã€nfs æ¦‚è¿° nfs æ˜¯ä»€ä¹ˆï¼Ÿ  å•çº¯çš„å­˜å‚¨ï¼šç¡¬ç›˜ã€u ç›˜ç­‰ç­‰  nfsï¼šå…±äº«å­˜å‚¨ï¼ˆnetwork filesystemï¼‰ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ  nfs ä¸»è¦ç”¨äº Linux ç³»ç»Ÿä¹‹é—´ sambaï¼šå¯ç”¨äº linux ä¸ windows å…±äº«å­˜å‚¨ ftpï¼šwindowsã€linuxã€mac ä¹‹é—´å…±äº«   åˆ†å¸ƒå¼å­˜å‚¨ï¼šFastDFSã€GlusterFSï¼ˆGFSï¼‰ï¼ŒHDFSï¼ˆå¤§æ•°æ®ï¼‰  ä¸ºä»€ä¹ˆä½¿ç”¨[å¦‚æœæ²¡">
<meta property="og:type" content="article">
<meta property="og:title" content="NFSå­˜å‚¨">
<meta property="og:url" content="https://mettafy.github.io/2024/07/29/%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84/%E5%A4%87%E4%BB%BD%E4%B8%8E%E5%AD%98%E5%82%A8/02-NFS%E5%AD%98%E5%82%A8%E6%9C%8D%E5%8A%A1/index.html">
<meta property="og:site_name" content="DevOps">
<meta property="og:description" content="ä¸€ã€nfs æ¦‚è¿° nfs æ˜¯ä»€ä¹ˆï¼Ÿ  å•çº¯çš„å­˜å‚¨ï¼šç¡¬ç›˜ã€u ç›˜ç­‰ç­‰  nfsï¼šå…±äº«å­˜å‚¨ï¼ˆnetwork filesystemï¼‰ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ  nfs ä¸»è¦ç”¨äº Linux ç³»ç»Ÿä¹‹é—´ sambaï¼šå¯ç”¨äº linux ä¸ windows å…±äº«å­˜å‚¨ ftpï¼šwindowsã€linuxã€mac ä¹‹é—´å…±äº«   åˆ†å¸ƒå¼å­˜å‚¨ï¼šFastDFSã€GlusterFSï¼ˆGFSï¼‰ï¼ŒHDFSï¼ˆå¤§æ•°æ®ï¼‰  ä¸ºä»€ä¹ˆä½¿ç”¨[å¦‚æœæ²¡">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://mettafy.github.io/img/touxiang.png">
<meta property="article:published_time" content="2024-07-29T16:10:00.000Z">
<meta property="article:modified_time" content="2024-08-01T10:59:34.935Z">
<meta property="article:author" content="Metta">
<meta property="article:tag" content="æ–‡æ¡£">
<meta property="article:tag" content="åŸºç¡€">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://mettafy.github.io/img/touxiang.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://mettafy.github.io/2024/07/29/%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84/%E5%A4%87%E4%BB%BD%E4%B8%8E%E5%AD%98%E5%82%A8/02-NFS%E5%AD%98%E5%82%A8%E6%9C%8D%E5%8A%A1/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}","hits_stats":"å…±æ‰¾åˆ° ${hits} ç¯‡æ–‡ç« "}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: 'å¤©',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“ä¸­æ–‡","cht_to_chs":"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“ä¸­æ–‡","day_to_night":"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'NFSå­˜å‚¨',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-08-01 18:59:34'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/echarts@4.9.0/dist/echarts.min.js"></script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://unpkg.zhimg.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.min.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/touxiang.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">2</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">2</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="DevOps"><span class="site-name">DevOps</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">NFSå­˜å‚¨</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2024-07-29T16:10:00.000Z" title="å‘è¡¨äº 2024-07-30 00:10:00">2024-07-30</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2024-08-01T10:59:34.935Z" title="æ›´æ–°äº 2024-08-01 18:59:34">2024-08-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84/">ç»¼åˆæ¶æ„</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">4668</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>21åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="NFSå­˜å‚¨"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><h1 id="ä¸€ã€nfs-æ¦‚è¿°"><a href="#ä¸€ã€nfs-æ¦‚è¿°" class="headerlink" title="ä¸€ã€nfs æ¦‚è¿°"></a>ä¸€ã€nfs æ¦‚è¿°</h1><ul>
<li><p>nfs æ˜¯ä»€ä¹ˆï¼Ÿ</p>
</li>
<li><p>å•çº¯çš„å­˜å‚¨ï¼šç¡¬ç›˜ã€u ç›˜ç­‰ç­‰</p>
</li>
<li><p><strong>nfsï¼šå…±äº«å­˜å‚¨ï¼ˆnetwork filesystemï¼‰ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ</strong></p>
<ul>
<li><strong>nfs ä¸»è¦ç”¨äº Linux ç³»ç»Ÿä¹‹é—´</strong></li>
<li>sambaï¼šå¯ç”¨äº linux ä¸ windows å…±äº«å­˜å‚¨</li>
<li>ftpï¼šwindowsã€linuxã€mac ä¹‹é—´å…±äº«</li>
</ul>
</li>
<li><p>åˆ†å¸ƒå¼å­˜å‚¨ï¼šFastDFSã€<strong>GlusterFSï¼ˆGFSï¼‰</strong>ï¼ŒHDFSï¼ˆå¤§æ•°æ®ï¼‰</p>
</li>
<li><p>ä¸ºä»€ä¹ˆä½¿ç”¨<br>[å¦‚æœæ²¡æœ‰ nfs å…±äº«]</p>
</li>
<li><p>A ä¸Šä¼ ä»¥åï¼Œåªæœ‰ web01 æœ‰å›¾ç‰‡ï¼Œè€Œæ­¤æ—¶ç”¨æˆ· B è®¿é—®çš„æ˜¯ web02 å°±ä¼šæ‰¾ä¸åˆ° A ä¸Šä¼ çš„å›¾ç‰‡</p>
</li>
</ul>
<p><img src="/images/202403291245681.png"></p>
<p>[å¦‚æœä½¿ç”¨äº† nfs]</p>
<ul>
<li>æ­¤æ—¶æ— è®ºæ˜¯å“ªä¸ªç”¨æˆ·ï¼Œéƒ½å¯ä»¥çœ‹åˆ° A ä¸Šä¼ çš„å›¾ç‰‡</li>
</ul>
<p><img src="/images/202403291245117.png"></p>
<ul>
<li>nfs å­˜æ”¾ä»€ä¹ˆï¼Ÿ</li>
<li>å­˜æ”¾ç”¨æˆ·ä¸Šä¼ çš„æ•°æ®ï¼ˆå›¾ç‰‡ã€è§†é¢‘ç­‰ç­‰ï¼‰</li>
</ul>
<h1 id="äºŒã€nfs-çš„å·¥ä½œåŸç†"><a href="#äºŒã€nfs-çš„å·¥ä½œåŸç†" class="headerlink" title="äºŒã€nfs çš„å·¥ä½œåŸç†"></a>äºŒã€nfs çš„å·¥ä½œåŸç†</h1><p><strong>- RPC å’Œ nfs çš„å…³ç³»</strong></p>
<blockquote>
<p>ğŸ‘ºï¼š ä»€ä¹ˆæ˜¯ RPCï¼Ÿ</p>
<ul>
<li>RPC æ˜¯ NFS çš„å®ˆæŠ¤è¿›ç¨‹ï¼Œç”±äº NFS æ²¡æœ‰å›ºå®šçš„ç«¯å£ï¼Œæ¯å¯åŠ¨ä¸€ä¸ªåŠŸèƒ½å°±éœ€è¦å¯åŠ¨ä¸€ä¸ªç«¯å£è¿›è¡Œä¼ è¾“æ•°æ®ï¼Œå®ƒä¼šéšæœºå¯ç”¨ä¸€äº›æœªè¢«ä½¿ç”¨çš„ç«¯å£è¿›è¡Œä¼ è¾“ï¼Œæ‰€ä»¥éœ€è¦è°ƒç”¨RPCæœåŠ¡</li>
<li>RPC çš„ä¸»è¦åŠŸèƒ½å°±æ˜¯è®°å½• NFS åŠŸèƒ½æ‰€å¯¹åº”çš„ç«¯å£ï¼Œå¹¶å°† NFS å®¢æˆ·ç«¯è¯·æ±‚æ—¶å°†å¯¹åº”çš„ä¿¡æ¯ä¼ é€’ç»™å®¢æˆ·ç«¯ï¼Œä»è€Œä½¿å®¢æˆ·ç«¯å¯ä»¥æ­£ç¡®è¿æ¥åˆ° NFS æœåŠ¡</li>
</ul>
</blockquote>
<ul>
<li>NFS å·¥ä½œæµç¨‹</li>
</ul>
<p><img src="/images/202403291246254.png"></p>
<h1 id="ä¸‰ã€å®æˆ˜"><a href="#ä¸‰ã€å®æˆ˜" class="headerlink" title="ä¸‰ã€å®æˆ˜"></a>ä¸‰ã€å®æˆ˜</h1><table>
<thead>
<tr>
<th align="left">ä¸»æœº</th>
<th align="left">ip</th>
<th align="left">è§’è‰²</th>
</tr>
</thead>
<tbody><tr>
<td align="left">nfs01</td>
<td align="left">192.168.1.40</td>
<td align="left">æœåŠ¡ç«¯</td>
</tr>
<tr>
<td align="left">web01</td>
<td align="left">192.168.1.20</td>
<td align="left">å®¢æˆ·ç«¯</td>
</tr>
</tbody></table>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># nfsæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯éƒ½å®‰è£…ä¸Šnfsã€rpc</span></span><br><span class="line">yum install -y nfs-utils rpcbind</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##å…ˆå¯åŠ¨rpcbind</span></span><br><span class="line">[root@nfs01 ~]# systemctl start rpcbind</span><br><span class="line"></span><br><span class="line"><span class="comment">###æŸ¥çœ‹rpcä¿¡æ¯ï¼Œæ­¤æ—¶å¹¶æ²¡æœ‰nfsä¿¡æ¯</span></span><br><span class="line">[root@nfs01 ~]# rpcinfo -p</span><br><span class="line">   program vers proto   port  service</span><br><span class="line">    100000    4   tcp    111  portmapper</span><br><span class="line">    100000    3   tcp    111  portmapper</span><br><span class="line">    100000    2   tcp    111  portmapper</span><br><span class="line">    100000    4   udp    111  portmapper</span><br><span class="line">    100000    3   udp    111  portmapper</span><br><span class="line">    100000    2   udp    111  portmapper</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">###å¯åŠ¨NFS</span></span><br><span class="line">[root@nfs01 ~]# systemctl start nfs</span><br><span class="line"></span><br><span class="line"><span class="comment">## å†æ¬¡æŸ¥çœ‹rpcä¿¡æ¯ï¼Œä¼šå¤šäº†ä¸€äº›nfsçš„ä¿¡æ¯</span></span><br><span class="line">[root@nfs01 ~]# rpcinfo -p</span><br><span class="line">   program vers proto   port  service</span><br><span class="line">    100000    4   tcp    111  portmapper</span><br><span class="line">    100000    3   tcp    111  portmapper</span><br><span class="line">    100000    2   tcp    111  portmapper</span><br><span class="line">    100000    4   udp    111  portmapper</span><br><span class="line">    100000    3   udp    111  portmapper</span><br><span class="line">    100000    2   udp    111  portmapper</span><br><span class="line">    100024    1   udp  55257  status</span><br><span class="line">    100024    1   tcp  51640  status</span><br><span class="line">    100005    1   udp  20048  mountd</span><br><span class="line">    100005    1   tcp  20048  mountd</span><br><span class="line">    100005    2   udp  20048  mountd</span><br><span class="line">    100005    2   tcp  20048  mountd</span><br><span class="line">    100005    3   udp  20048  mountd</span><br><span class="line">    100005    3   tcp  20048  mountd</span><br><span class="line">    100003    3   tcp   2049  nfs</span><br><span class="line">    100003    4   tcp   2049  nfs</span><br><span class="line">    100227    3   tcp   2049  nfs_acl</span><br><span class="line">    100003    3   udp   2049  nfs</span><br><span class="line">    100003    4   udp   2049  nfs</span><br><span class="line">    100227    3   udp   2049  nfs_acl</span><br><span class="line">    100021    1   udp  49965  nlockmgr</span><br><span class="line">    100021    3   udp  49965  nlockmgr</span><br><span class="line">    100021    4   udp  49965  nlockmgr</span><br><span class="line">    100021    1   tcp  42359  nlockmgr</span><br><span class="line">    100021    3   tcp  42359  nlockmgr</span><br><span class="line">    100021    4   tcp  42359  nlockmgr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®å¼€æœºè‡ªå¯</span></span><br><span class="line">[root@nfs01 ~]# systemctl <span class="built_in">enable</span> rpcbind nfs</span><br><span class="line">Created symlink from /etc/systemd/system/multi-user.target.wants/nfs-server.service to /usr/lib/systemd/system/nfs-server.service.</span><br></pre></td></tr></table></figure>




<p><code>å‘½ä»¤æ ¼å¼ï¼š/data 192.168.168.1.0/24(rw)</code></p>
<blockquote>
<p>æ³¨æ„ï¼šæŒ‚è½½ç›®å½•å’Œ ip ä¹‹é—´æœ‰ç©ºæ ¼ï¼Œip å’Œæ‹¬å·ä¹‹é—´æ²¡æœ‰ç©ºæ ¼</p>
</blockquote>
<p><img src="/images/202403291247408.png"></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä¿®æ”¹nfsé…ç½®æ–‡ä»¶</span></span><br><span class="line">[root@nfs01 ~]# <span class="built_in">cat</span> /etc/exports</span><br><span class="line">/data 192.168.1.0/24(rw)</span><br><span class="line"></span><br><span class="line"><span class="comment">## å®‰è£…å®Œæˆåï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªé»˜è®¤ç”¨æˆ·</span></span><br><span class="line">[root@nfs01 ~]# <span class="built_in">id</span> nfsnobody</span><br><span class="line">uid=65534(nfsnobody) gid=65534(nfsnobody) <span class="built_in">groups</span>=65534(nfsnobody)</span><br><span class="line"></span><br><span class="line"><span class="comment">##æ­¤æ—¶ä¸è¦é‡å¯nfsï¼Œè¿˜æ²¡æœ‰åˆ›å»ºå…±äº«ç›®å½•</span></span><br><span class="line"><span class="comment">###åˆ›å»ºç›®å½•ï¼Œä¿®æ”¹ç”¨æˆ·å’Œç»„</span></span><br><span class="line">[root@nfs01 ~]# <span class="built_in">mkdir</span> /data</span><br><span class="line">[root@nfs01 ~]# <span class="built_in">chown</span> -R nfsnobody.nfsnobody /data/</span><br><span class="line">[root@nfs01 ~]# ll -d /data/</span><br><span class="line">drwxr-xr-x 2 nfsnobody nfsnobody 6 Aug 22 19:41 /data/</span><br><span class="line"></span><br><span class="line">[root@nfs01 ~]# systemctl restart nfs</span><br><span class="line"></span><br><span class="line"><span class="comment">## åŠ ipæŸ¥çœ‹æŒ‡å®šipä¸‹æ˜¯å¦æœ‰å…±äº«ç›®å½•</span></span><br><span class="line"><span class="comment">## ä¸åŠ ipæŸ¥çœ‹å½“å‰æœºå™¨ä¸‹æœ‰æ²¡æœ‰å…±äº«ç›®å½•</span></span><br><span class="line">[root@nfs01 ~]# showmount -e 192.168.1.40</span><br><span class="line">Export list <span class="keyword">for</span> 192.168.1.40:</span><br><span class="line">/data 192.168.1.0/24</span><br><span class="line">[root@nfs01 ~]# showmount -e </span><br><span class="line">Export list <span class="keyword">for</span> nfs01:</span><br><span class="line">/data 192.168.1.0/24</span><br></pre></td></tr></table></figure>

<p><code>[æµ‹è¯•]</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æœåŠ¡ç«¯æœ¬åœ°æŒ‚è½½</span></span><br><span class="line">[root@nfs01 ~]# ll /mnt/</span><br><span class="line">total 0</span><br><span class="line">[root@nfs01 ~]# mount -t nfs 192.168.1.40:/data /mnt</span><br><span class="line">[root@nfs01 ~]# <span class="built_in">touch</span> /mnt/1.txt</span><br><span class="line">[root@nfs01 ~]# ll /mnt/</span><br><span class="line">total 0</span><br><span class="line">-rw-r--r-- 1 nfsnobody nfsnobody 0 Aug 22 19:46 1.txt</span><br><span class="line">[root@nfs01 ~]# ll /data/</span><br><span class="line">total 0</span><br><span class="line">-rw-r--r-- 1 nfsnobody nfsnobody 0 Aug 22 19:46 1.txt</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®¢æˆ·ç«¯web01æŒ‚è½½</span></span><br><span class="line">[root@web01 script]# showmount -e 192.168.1.40</span><br><span class="line">Export list <span class="keyword">for</span> 192.168.1.40:</span><br><span class="line">/data 192.168.1.0/24</span><br><span class="line"></span><br><span class="line">[root@web01 script]# mount -t nfs 192.168.1.40:/data /server/bbz</span><br><span class="line">[root@web01 script]# ll -d /server/bbz/</span><br><span class="line">drwxr-xr-x 2 nfsnobody nfsnobody 19 Aug 22 19:46 /server/bbz/</span><br><span class="line"></span><br><span class="line">[root@web01 script]# ll /server/bbz/</span><br><span class="line">total 0</span><br><span class="line">-rw-r--r-- 1 nfsnobody nfsnobody 0 Aug 22 19:46 1.txt</span><br><span class="line"></span><br><span class="line">[root@web01 script]# <span class="built_in">touch</span> /server/bbz/&#123;2..100&#125;.txt</span><br><span class="line">[root@web01 script]# ll /server/bbz/</span><br><span class="line">total 0</span><br><span class="line">-rw-r--r-- 1 nfsnobody nfsnobody 0 Aug 22 19:50 100.txt</span><br><span class="line">-rw-r--r-- 1 nfsnobody nfsnobody 0 Aug 22 19:50 10.txt</span><br><span class="line">-rw-r--r-- 1 nfsnobody nfsnobody 0 Aug 22 19:50 11.txt</span><br><span class="line">-rw-r--r-- 1 nfsnobody nfsnobody 0 Aug 22 19:50 12.txt</span><br><span class="line">....</span><br><span class="line"></span><br><span class="line"><span class="comment">## æˆ‘ä»¬å»nfsæœºå™¨ä¸Šçœ‹çœ‹æ˜¯ä¸æ˜¯ä¹Ÿæœ‰</span></span><br><span class="line">[root@nfs01 ~]# ll /data/</span><br><span class="line">total 0</span><br><span class="line">-rw-r--r-- 1 nfsnobody nfsnobody 0 Aug 22 19:50 100.txt</span><br><span class="line">-rw-r--r-- 1 nfsnobody nfsnobody 0 Aug 22 19:50 10.txt</span><br><span class="line">-rw-r--r-- 1 nfsnobody nfsnobody 0 Aug 22 19:50 11.txt</span><br><span class="line">....</span><br></pre></td></tr></table></figure>



<h1 id="å››ã€æœåŠ¡ç«¯å‚æ•°"><a href="#å››ã€æœåŠ¡ç«¯å‚æ•°" class="headerlink" title="å››ã€æœåŠ¡ç«¯å‚æ•°"></a>å››ã€æœåŠ¡ç«¯å‚æ•°</h1><p><img src="/images/202403291247408.png"></p>
<blockquote>
<p>æœ¬èŠ‚ä¸»è¦è®²è§£æœ€åé¢çš„å‚æ•°ï¼ˆrwã€syncâ€¦.ï¼‰</p>
</blockquote>
<table>
<thead>
<tr>
<th align="left">nfs æœåŠ¡ç«¯ï¼Œå…±äº«å‚æ•°</th>
<th align="left"></th>
<th align="left"></th>
</tr>
</thead>
<tbody><tr>
<td align="left">rw</td>
<td align="left">å¯è¯»å†™</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">ro</td>
<td align="left">åªè¯»&nbsp; read only</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">sync</td>
<td align="left">åŒæ­¥å†™å…¥</td>
<td align="left">åŒæ—¶å°†æ•°æ®å†™å…¥å†…å­˜å’Œç£ç›˜ä¸­ï¼Œä¸ä¼šä¸¢å¤±æ•°æ®</td>
</tr>
<tr>
<td align="left">async</td>
<td align="left">å¼‚æ­¥å†™å…¥</td>
<td align="left">ä¼˜å…ˆå°†æ•°æ®å†™å…¥å†…å­˜ï¼Œå†å†™å…¥ç£ç›˜ï¼Œæ•ˆç‡æ›´é«˜ï¼Œä½†å¯èƒ½ä¼šä¸¢å¤±æ•°æ®</td>
</tr>
<tr>
<td align="left">anonuid</td>
<td align="left">anonymousï¼šæŒ‡å®šç”¨æˆ·uid</td>
<td align="left">æŒ‡å®šå®¢æˆ·ç«¯æ˜ å°„åˆ°æœåŠ¡ç«¯ä½¿ç”¨çš„ç”¨æˆ·</td>
</tr>
<tr>
<td align="left">anongid</td>
<td align="left">æŒ‡å®šç”¨æˆ·gid</td>
<td align="left">æŒ‡å®šå®¢æˆ·ç«¯æ˜ å°„åˆ°æœåŠ¡ç«¯ä½¿ç”¨çš„ç”¨æˆ·ç»„</td>
</tr>
<tr>
<td align="left">root_squash</td>
<td align="left">NFS å®¢æˆ·ç«¯ä»¥ root ç®¡ç†å‘˜è®¿é—®æ—¶ï¼Œæ˜ å°„ä¸º NFS çš„åŒ¿åç”¨æˆ·ï¼ˆä¸å¸¸ç”¨ï¼‰</td>
<td align="left">root&nbsp; â€“&gt; nfsnobody</td>
</tr>
<tr>
<td align="left">no_root_squash</td>
<td align="left">NFSå®¢æˆ·ç«¯ä»¥rootè®¿é—®æ—¶ï¼Œæ˜ å°„ä¸ºNFSæœåŠ¡ç«¯çš„rootç”¨æˆ·ï¼ˆä¸å¸¸ç”¨ï¼‰</td>
<td align="left">å®¢æˆ·ç«¯root&nbsp; â€“&gt;&nbsp; æœåŠ¡ç«¯root</td>
</tr>
<tr>
<td align="left">all_squash</td>
<td align="left">æ— è®ºNFSå®¢æˆ·ç«¯ä½¿ç”¨ä»€ä¹ˆç”¨æˆ·è®¿é—®ï¼Œå‡æ˜ å°„ä¸ºåŒ¿åç”¨æˆ·</td>
<td align="left">all â€“&gt;&nbsp; nfsnobody</td>
</tr>
<tr>
<td align="left">no_all_squash</td>
<td align="left">æ— è®ºå®¢æˆ·ç«¯ä½¿ç”¨ä»€ä¹ˆç”¨æˆ·è®¿é—®ï¼Œéƒ½ä¸è¿›è¡Œå‹ç¼©</td>
<td align="left">all&nbsp; â€“&gt;&nbsp; all</td>
</tr>
</tbody></table>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># nfsæŒ‚è½½ï¼Œrwä¸ro</span></span><br><span class="line">[root@nfs01 ~]# <span class="built_in">cat</span> /etc/exports</span><br><span class="line">/data/blog 192.168.1.0/24(rw)</span><br><span class="line">/data/rw   192.168.1.0/24(rw)</span><br><span class="line">/data/ro   192.168.1.0/24(ro)</span><br><span class="line"></span><br><span class="line">[root@nfs01 ~]# <span class="built_in">mkdir</span> -p /data/&#123;rw,ro&#125;</span><br><span class="line"></span><br><span class="line">[root@nfs01 ~]# systemctl restart nfs</span><br><span class="line">[root@nfs01 ~]# showmount -e</span><br><span class="line">Export list <span class="keyword">for</span> nfs01:</span><br><span class="line">/data/ro   192.168.1.0/24</span><br><span class="line">/data/rw   192.168.1.0/24</span><br><span class="line">/data/blog 192.168.1.0/24</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## æœ¬åœ°æŒ‚è½½ä¸€ä¸‹</span></span><br><span class="line"><span class="comment">### rwæ­£å¸¸å†™å…¥</span></span><br><span class="line">[root@nfs01 ~]# mount -t nfs 192.168.1.40:/data/rw /mnt</span><br><span class="line">[root@nfs01 ~]# <span class="built_in">chown</span> -R nfsnobody.nfsnobody /data</span><br><span class="line">[root@nfs01 ~]# <span class="built_in">touch</span> /mnt/1.txt</span><br><span class="line">[root@nfs01 ~]# ll /mnt/</span><br><span class="line">total 0</span><br><span class="line">-rw-r--r-- 1 nfsnobody nfsnobody 0 Aug 25 19:08 1.txt</span><br><span class="line"></span><br><span class="line"><span class="comment">### å»æ‰æŒ‚è½½ç‚¹</span></span><br><span class="line">[root@nfs01 ~]# umount -v /mnt/</span><br><span class="line">/mnt: nfs4 mount point detected</span><br><span class="line">/mnt: umounted</span><br><span class="line"></span><br><span class="line"><span class="comment">## æŒ‚è½½roå¯è¯»ç›®å½•ï¼Œæ— æ³•å†™å…¥æ–‡ä»¶</span></span><br><span class="line">[root@nfs01 ~]# mount -t nfs 192.168.1.40:/data/ro /mnt/</span><br><span class="line">[root@nfs01 ~]# <span class="built_in">touch</span> /mnt/1.txt</span><br><span class="line"><span class="built_in">touch</span>: cannot <span class="built_in">touch</span> â€˜/mnt/1.txtâ€™: Read-only file system</span><br></pre></td></tr></table></figure>



<p>[sync å’Œ async]</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## å¦‚æœæˆ‘ä»¬ä¸é…ç½®ï¼Œåˆ™é»˜è®¤ä½¿ç”¨sync</span></span><br><span class="line">[root@nfs01 ~]# <span class="built_in">cat</span> /var/lib/nfs/etab </span><br><span class="line">/data/rw	192.168.1.0/24(rw,<span class="built_in">sync</span>,wdelay,hide,nocrossmnt,secure,root_squash,no_all_squash,no_subtree_check,secure_locks,acl,no_pnfs,anonuid=65534,anongid=65534,sec=sys,rw,secure,root_squash,no_all_squash)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤æ‰€æœ‰æ•°æ®ï¼Œè¿›è¡Œæµ‹è¯•</span></span><br><span class="line">[root@nfs01 ~]# <span class="built_in">rm</span> -rf /data/rw/*</span><br><span class="line"><span class="comment"># åŠ¨æ€æŸ¥çœ‹ç›®å½•å†…å®¹</span></span><br><span class="line">[root@nfs01 ~]# watch <span class="built_in">ls</span> -l /data/rw/</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®¢æˆ·ç«¯å†™å…¥å¤§æ–‡ä»¶</span></span><br><span class="line">[root@web01 ~]# <span class="built_in">dd</span> <span class="keyword">if</span>=/dev/zero of=/tmp/big bs=1M count=500</span><br><span class="line">500+0 records <span class="keyword">in</span></span><br><span class="line">500+0 records out</span><br><span class="line">524288000 bytes (524 MB) copied, 5.18806 s, 101 MB/s</span><br><span class="line">[root@web01 ~]# <span class="built_in">cp</span> /tmp/big /mnt/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## ä½ ä¼šå‘ç°æœåŠ¡ç«¯ç›®å½•ä¸‹çš„æ–‡ä»¶å¹¶ä¸æ˜¯ç›´æ¥å…¨éƒ¨å†™å…¥ç£ç›˜ï¼Œè€Œæ˜¯åœ¨æ…¢æ…¢å˜å¤§</span></span><br></pre></td></tr></table></figure>

<p><img src="/images/202403291249497.png"></p>
<p><img src="/images/202403291250570.png"></p>
<p>[anonuid å’Œ anongid]</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###  é»˜è®¤ä½¿ç”¨äº†è‡ªåŠ¨åˆ›å»ºçš„nfsnobodyç”¨æˆ·å’Œç»„</span></span><br><span class="line"><span class="comment">###  anonuid=65534,anongid=65534</span></span><br><span class="line"></span><br><span class="line">[root@nfs01 ~]# <span class="built_in">cat</span> /var/lib/nfs/etab </span><br><span class="line">/data/rw	192.168.1.0/24(rw,<span class="built_in">sync</span>,wdelay,hide,nocrossmnt,secure,root_squash,no_all_squash,no_subtree_check,secure_locks,acl,no_pnfs,anonuid=65534,anongid=65534,sec=sys,rw,secure,root_squash,no_all_squash)</span><br></pre></td></tr></table></figure>



<ul>
<li>ç”¨æˆ·å‹ç¼©</li>
<li>é»˜è®¤ï¼šroot_squash, no_all_squash</li>
</ul>
<p><img src="/images/202403291250686.png"></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## nfsé»˜è®¤çš„è®¾ç½®ï¼Œå½“å®¢æˆ·ç«¯ä½¿ç”¨rootè®¿é—®æ—¶å‹ç¼©ä¸ºåŒ¿åç”¨æˆ·</span></span><br><span class="line"><span class="comment">## å…¶ä»–ç”¨æˆ·è®¿é—®æ—¶ï¼Œä¸è¿›è¡Œå‹ç¼©</span></span><br><span class="line">/data/rw	192.168.1.0/24(rw,<span class="built_in">sync</span>,wdelay,hide,nocrossmnt,secure,root_squash,no_all_squash,no_subtree_check,secure_locks,acl,no_pnfs,anonuid=65534,anongid=65534,sec=sys,rw,secure,root_squash,no_all_squash)</span><br><span class="line"></span><br><span class="line">[root@nfs01 ~]# <span class="built_in">cat</span> /etc/exports</span><br><span class="line">/data/blog 192.168.1.0/24(rw)</span><br><span class="line">/data/rw   192.168.1.0/24(rw)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## å…¶ä»–ç”¨æˆ·åªæœ‰è®¿é—®æƒé™ï¼Œæ²¡æœ‰å†™æƒé™</span></span><br><span class="line">[zzz@web01 ~]$ <span class="built_in">touch</span> /mnt/3.txt</span><br><span class="line"><span class="built_in">touch</span>: cannot <span class="built_in">touch</span> â€˜/mnt/3.txtâ€™: Permission denied</span><br><span class="line">[zzz@web01 ~]$ ll /mnt/</span><br><span class="line">-rw-r--r-- 1 nfsnobody nfsnobody 0 Aug 25 22:00 1.txt</span><br><span class="line">-rw-rw-r-- 1 nfsnobody nfsnobody 0 Aug 25 22:00 2.txt</span><br></pre></td></tr></table></figure>


<ul>
<li><strong>all_squash</strong> ï¼ˆå¸¸ç”¨ï¼‰</li>
<li>ä¸è®ºä»€ä¹ˆç”¨æˆ·éƒ½è¿›è¡Œå‹ç¼©<br><img src="/images/202403291251648.png"></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># å®¢æˆ·ç«¯ä½¿ç”¨rootç”¨æˆ·åˆ›å»ºæ–‡ä»¶</span></span></span><br><span class="line">[root@nfs01 ~]# touch /mnt/1.txt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æœåŠ¡ç«¯æŸ¥çœ‹åˆ›å»ºçš„æ–‡ä»¶uidã€gidï¼Œä¼šå‘ç°è¢«å‹ç¼©äº†</span></span><br><span class="line">-rw-r--r-- 1 nfsnobody nfsnobody 0 Aug 25 22:00 1.txt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># å®¢æˆ·ç«¯ä½¿ç”¨æ™®é€šç”¨æˆ·åˆ›å»ºæ–‡ä»¶</span></span></span><br><span class="line">[root@nfs01 ~]# su - zzz</span><br><span class="line">[zzz@nfs01 ~]$ touch /mnt/2.txt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># æœåŠ¡ç«¯æŸ¥çœ‹</span></span></span><br><span class="line">-rw-rw-r-- 1 nfsnobody nfsnobody 0 Aug 25 22:00 2.txt</span><br></pre></td></tr></table></figure>


<ul>
<li><strong>all_squash, anonuid+anongid</strong> ï¼ˆå¸¸ç”¨ï¼‰</li>
<li>å‹ç¼©ä¸ºæŒ‡å®šç”¨æˆ·ï¼Œé˜²æ­¢ä¸€äº›ç”¨æˆ·æƒé™é—®é¢˜</li>
</ul>
<p><img src="/images/202403291252397.png"></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æœåŠ¡ç«¯ã€å®¢æˆ·ç«¯åˆ›å»ºæŒ‡å®šç”¨æˆ·</span></span><br><span class="line">groupadd -g 888 www</span><br><span class="line">useradd -s /sbin/nologin -M -u 888 -g 888 www</span><br><span class="line"><span class="built_in">id</span> www</span><br><span class="line">uid=888(www) gid=888(www) <span class="built_in">groups</span>=888(www)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®å…±äº«ç›®å½•ä¸ºæŒ‡å®šç”¨æˆ·ï¼Œå¦åˆ™å®¢æˆ·ç«¯æ²¡æœ‰å†™å…¥æƒé™</span></span><br><span class="line">[root@nfs01 ~]# <span class="built_in">chown</span> -R www.www /data/rw</span><br><span class="line">[root@nfs01 ~]# ll -d /data/rw</span><br><span class="line">drwxr-xr-x 2 www www 32 Aug 25 22:00 /data/rw</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹é…ç½®æ–‡ä»¶</span></span><br><span class="line">[root@nfs01 ~]# <span class="built_in">cat</span> /etc/exports</span><br><span class="line">/data/blog 192.168.1.0/24(rw)</span><br><span class="line">/data/rw   192.168.1.0/24(rw,all_squash,anonuid=888,anongid=888)</span><br><span class="line"></span><br><span class="line"><span class="comment">## æµ‹è¯•</span></span><br><span class="line">[root@web01 ~]# <span class="built_in">touch</span> /mnt/q.txt</span><br><span class="line">[root@web01 ~]# su - zzz</span><br><span class="line">Last login: Fri Aug 25 22:43:04 CST 2023 on pts/0</span><br><span class="line">[zzz@web01 ~]$ <span class="built_in">touch</span> /mnt/as.txt</span><br><span class="line"></span><br><span class="line">[root@nfs01 ~]# ll  /data/rw</span><br><span class="line">-rw-rw-r-- 1 www www 0 Aug 25 22:46 as.txt</span><br><span class="line">-rw-r--r-- 1 www www 0 Aug 25 22:46 q.txt</span><br></pre></td></tr></table></figure>




<h1 id="äº”ã€å®¢æˆ·ç«¯æŒ‚è½½å‚æ•°"><a href="#äº”ã€å®¢æˆ·ç«¯æŒ‚è½½å‚æ•°" class="headerlink" title="äº”ã€å®¢æˆ·ç«¯æŒ‚è½½å‚æ•°"></a>äº”ã€å®¢æˆ·ç«¯æŒ‚è½½å‚æ•°</h1><ul>
<li>å®¢æˆ·ç«¯æŒ‚è½½ï¼šmount å‘½ä»¤</li>
<li>æŒ‚è½½ä¿¡æ¯æ–‡ä»¶è·¯å¾„ï¼š&#x2F;proc&#x2F;mounts</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@web01 ~]# grep 192.168.1.40 /proc/mounts </span><br><span class="line">192.168.1.40:/data/rw /mnt nfs4 rw,relatime,vers=4.1,rsize=131072,wsize=131072,namlen=255,hard,proto=tcp,timeo=600,retrans=2,sec=sys,clientaddr=192.168.1.20,local_lock=none,addr=192.168.1.40 0 0</span><br></pre></td></tr></table></figure>


<table>
<thead>
<tr>
<th align="left">å‚æ•°</th>
<th align="left">æè¿°</th>
<th align="left"></th>
</tr>
</thead>
<tbody><tr>
<td align="left">-t</td>
<td align="left">æŒ‡å®šæ–‡ä»¶ç³»ç»Ÿç±»å‹</td>
<td align="left">æœ¬åœ°ï¼šxfsã€ext4&#x2F;ext3<div>è¿œç¨‹ï¼šnfs ç­‰ç­‰</div></td>
</tr>
<tr>
<td align="left">-o</td>
<td align="left">æŒ‡å®šæŒ‚è½½è¯¦ç»†å‚æ•°</td>
<td align="left"></td>
</tr>
</tbody></table>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æœ‰æ—¶å€™å¸è½½å…±äº«ç›®å½•ä¼šå‡ºç°å¡ä½å’ŒæŠ¥é”™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `-lf` å‚æ•°å¼ºåˆ¶å¸è½½ </span></span><br><span class="line">[root@web01 ~]# umount -lf /mnt/</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># nfså®¢æˆ·ç«¯æŒ‚è½½æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ `-o`å°†å¯è¯»å†™ç›®å½•æŒ‚è½½ä¸ºåªè¯»</span></span><br><span class="line"><span class="comment">## ro åˆ™ä¸ºåªè¯»</span></span><br><span class="line">[root@web01 ~]# mount -t nfs -o ro 192.168.1.40:/data/rw /mnt</span><br><span class="line">[root@web01 ~]# <span class="built_in">df</span> -h</span><br><span class="line">Filesystem               Size  Used Avail Use% Mounted on</span><br><span class="line">devtmpfs                 898M     0  898M   0% /dev</span><br><span class="line">tmpfs                    910M     0  910M   0% /dev/shm</span><br><span class="line">tmpfs                    910M  9.6M  901M   2% /run</span><br><span class="line">tmpfs                    910M     0  910M   0% /sys/fs/cgroup</span><br><span class="line">/dev/mapper/centos-root   17G  7.2G  9.9G  43% /</span><br><span class="line">/dev/sda1               1014M  151M  864M  15% /boot</span><br><span class="line">tmpfs                    182M     0  182M   0% /run/user/0</span><br><span class="line">192.168.1.40:/data/rw     17G  1.9G   16G  11% /mnt</span><br><span class="line"></span><br><span class="line">[root@web01 ~]# grep 192.168.1.40 /proc/mounts </span><br><span class="line">192.168.1.40:/data/rw /mnt nfs4 ro,relatime,vers=4.1,rsize=131072,wsize=131072,namlen=255,hard,proto=tcp,timeo=600,retrans=2,sec=sys,clientaddr=192.168.1.20,local_lock=none,addr=192.168.1.40 0 0</span><br><span class="line"></span><br><span class="line">[root@web01 ~]# <span class="built_in">ls</span> /mnt/</span><br><span class="line">as.txt  q.txt</span><br><span class="line">[root@web01 ~]# <span class="built_in">touch</span> /mnt/3.txt</span><br><span class="line"><span class="built_in">touch</span>: cannot <span class="built_in">touch</span> â€˜/mnt/3.txtâ€™: Read-only file system</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## å°†ä¸Šé¢çš„roä¿®æ”¹ä¸ºrw</span></span><br><span class="line">[root@web01 ~]# mount -o rw,remount /mnt</span><br><span class="line">[root@web01 ~]# grep 192.168.1.40 /proc/mounts </span><br><span class="line">192.168.1.40:/data/rw /mnt nfs4 rw,relatime,vers=4.1,rsize=131072,wsize=131072,namlen=255,hard,proto=tcp,timeo=600,retrans=2,sec=sys,clientaddr=192.168.1.20,local_lock=none,addr=192.168.1.40 0 0</span><br></pre></td></tr></table></figure>

<ul>
<li><p><code>æ•…éšœæ¡ˆä¾‹ï¼š</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># èƒŒæ™¯ï¼šä»¥ä¸ºå†…ä¸€äº›åŸå› ç£ç›˜æ•…éšœï¼Œæ•´ä¸ªç£ç›˜ï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰å˜ä¸ºåªè¯»æ¨¡å¼ï¼ŒæŠ¥é”™ä¸ºï¼šRead-only file system</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ’æŸ¥ï¼šæŸ¥è¯¢å…·ä½“æ˜¯å“ªä¸ªåˆ†åŒºå˜ä¸ºåªè¯»ï¼Œä¾‹å¦‚/mntåˆ†åŒºåªè¯»</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å†³ï¼šmount -o  rw,remount /mnt</span></span><br></pre></td></tr></table></figure>

</li>
<li><p><code>æ°¸ä¹…æŒ‚è½½</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æˆ‘ä»¬ç°åœ¨ä½¿ç”¨å‘½ä»¤æŒ‚è½½ï¼Œéƒ½æ˜¯ä¸´æ—¶çš„</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## æ–¹æ³•1: å†™å…¥/etc/rc.local</span></span><br><span class="line"><span class="comment">## æ³¨æ„ï¼š/etc/rc.d/rc.localå¿…é¡»æœ‰æ‰§è¡Œæƒé™ chown +x</span></span><br><span class="line">[root@web01 ~]# <span class="built_in">chmod</span> +x /etc/rc.d/rc.local </span><br><span class="line">[root@web01 ~]# ll /etc/rc.d/rc.local </span><br><span class="line">-rwxr-xr-x. 1 root root 473 Oct  2  2020 /etc/rc.d/rc.local</span><br><span class="line">[root@web01 ~]# <span class="built_in">tail</span> -1 /etc/rc.local </span><br><span class="line">mount -t nfs -o rw 192.168.1.40:/data/rw /mnt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## æ–¹æ³•2ï¼šå†™å…¥/etc/fstabé‡Œ</span></span><br><span class="line">[root@web01 ~]# <span class="built_in">tail</span> -1 /etc/fstab </span><br><span class="line"><span class="comment"># è¿œç¨‹å…±äº«ç›®å½•ip+è·¯å¾„    #æœ¬åœ°æŒ‚è½½ç›®å½•  #æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿç±»å‹  #å‚æ•°ï¼ˆä»¥åå¯ä»¥å†™rwç­‰ç­‰ï¼‰ #0 0</span></span><br><span class="line">192.168.1.40:/data/rw  /code/blog  nfs defaults 0 0</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="å…­ã€-NFS-å­˜å‚¨å°ç»“"><a href="#å…­ã€-NFS-å­˜å‚¨å°ç»“" class="headerlink" title="å…­ã€ NFS å­˜å‚¨å°ç»“"></a>å…­ã€ NFS å­˜å‚¨å°ç»“</h1><h2 id="1-NFS-å­˜å‚¨ä¼˜ç‚¹"><a href="#1-NFS-å­˜å‚¨ä¼˜ç‚¹" class="headerlink" title="1. NFS å­˜å‚¨ä¼˜ç‚¹"></a>1. NFS å­˜å‚¨ä¼˜ç‚¹</h2><ul>
<li>01ï¼šNFS æ–‡ä»¶ç³»ç»Ÿç®€å•æ˜“ç”¨ã€æ–¹ä¾¿éƒ¨ç½²ã€æ•°æ®å¯é ã€æœåŠ¡ç¨³å®šï¼Œé€‚åˆä¸­å°å‹ä¼ä¸š</li>
<li>02ï¼šNFS æ–‡ä»¶ç³»ç»Ÿå†…å­˜æ”¾çš„æ•°æ®éƒ½åœ¨æ–‡ä»¶ç³»ç»Ÿä¹‹ä¸Šï¼Œæ‰€æœ‰æ•°æ®éƒ½çœ‹å¾—è§</li>
</ul>
<h2 id="2-NFS-å­˜å‚¨å±€é™"><a href="#2-NFS-å­˜å‚¨å±€é™" class="headerlink" title="2. NFS å­˜å‚¨å±€é™"></a>2. NFS å­˜å‚¨å±€é™</h2><ul>
<li>01ï¼šå­˜åœ¨å•ç‚¹æ•…éšœï¼Œå¦‚æœæ„å»ºé«˜å¯ç”¨ç»´æŠ¤éº»çƒ¦</li>
<li>02ï¼šNFS æ•°æ®æ˜æ–‡ï¼Œå¹¶ä¸å¯¹æ•°æ®åšä»»ä½•æ ¡éªŒ</li>
<li>03ï¼šå®¢æˆ·ç«¯æŒ‚è½½ NFS æœåŠ¡æ²¡æœ‰å¯†ç éªŒè¯ï¼Œå®‰å…¨æ€§ä¸€èˆ¬ï¼ˆåªæ¨èå†…ç½‘ä½¿ç”¨ï¼‰</li>
</ul>
<h2 id="3-NFS-åº”ç”¨å»ºè®®"><a href="#3-NFS-åº”ç”¨å»ºè®®" class="headerlink" title="3. NFS åº”ç”¨å»ºè®®"></a>3. NFS åº”ç”¨å»ºè®®</h2><ul>
<li>01ï¼šç”Ÿäº§åœºæ™¯åº”å°†é™æ€æ•°æ®å°½å¯èƒ½å¾€å‰ç«¯æ¨ï¼Œå‡å°‘åç«¯å‹åŠ›</li>
<li>02ï¼šå¿…é¡»å°†å­˜å‚¨é‡Œçš„é™æ€èµ„æºé€šè¿‡ CDN ç¼“å­˜ï¼ˆjpg|png|mp4|css|jsï¼‰</li>
<li>03ï¼šå¦‚æœæ²¡æœ‰ç¼“å­˜æˆ–æ¶æ„æœ¬èº«å†å²é—ç•™é—®é¢˜å¤ªå¤§ï¼Œå†å¤šå­˜å‚¨ä¹Ÿæ²¡ç”¨</li>
</ul>
<h1 id="ä¸ƒã€ä¼˜åŒ–è®¾ç½®"><a href="#ä¸ƒã€ä¼˜åŒ–è®¾ç½®" class="headerlink" title="ä¸ƒã€ä¼˜åŒ–è®¾ç½®"></a>ä¸ƒã€ä¼˜åŒ–è®¾ç½®</h1><h2 id="a-å®‰å…¨ä¼˜åŒ–-ï¼ˆæŒæ¡ï¼‰"><a href="#a-å®‰å…¨ä¼˜åŒ–-ï¼ˆæŒæ¡ï¼‰" class="headerlink" title="a.å®‰å…¨ä¼˜åŒ– ï¼ˆæŒæ¡ï¼‰"></a>a.å®‰å…¨ä¼˜åŒ– ï¼ˆæŒæ¡ï¼‰</h2><blockquote>
<p>å®¢æˆ·ç«¯æŒ‚è½½æ—¶é€‰æ‹©ä¸€äº›ä¼˜åŒ–å‚æ•°</p>
<ul>
<li>nosuid</li>
<li>nodev</li>
<li>noexec</li>
</ul>
</blockquote>
<table>
<thead>
<tr>
<th align="left">å‚æ•°</th>
<th align="left">æè¿°</th>
<th align="left"></th>
</tr>
</thead>
<tbody><tr>
<td align="left">suid<div>nosuid</div></td>
<td align="left">å½“æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿä¸Šæœ‰ SUID çš„ç¨‹åºæ—¶ï¼Œåªè¦ä½¿ç”¨ nosuid å°±èƒ½å–æ¶ˆè®¾ç½® SUID çš„åŠŸèƒ½</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">rw<div>ro</div></td>
<td align="left">å¯ä»¥æŒ‡å®šæ–‡ä»¶ç³»ç»Ÿæ˜¯åªè¯»ï¼ˆroï¼‰æˆ–è¯»å†™ï¼ˆrwï¼‰</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">dev<div>nodev</div></td>
<td align="left">æ˜¯å¦å¯ä»¥ä¿ç•™æŸäº›æ–‡ä»¶çš„ç‰¹æ®ŠåŠŸèƒ½</td>
<td align="left">ä¸€èˆ¬æ¥è¯´åªæœ‰&#x2F;dev æ‰æœ‰ç‰¹æ®Šçš„æ–‡ä»¶ï¼Œå› æ­¤å¯ä»¥é€‰æ‹© nodev</td>
</tr>
<tr>
<td align="left">exec<div>noexec</div></td>
<td align="left">æ˜¯å¦å…·æœ‰æ‰§è¡Œæ–‡ä»¶çš„æƒé™</td>
<td align="left">å¦‚æœæŒ‚è½½çš„åªæ˜¯æ™®é€šæ–‡ä»¶ï¼ˆå›¾ç‰‡ã€è§†é¢‘ã€â€¦ï¼‰é‚£ä¹ˆå¯ä»¥é€‰æ‹© noexec</td>
</tr>
<tr>
<td align="left">user<div>nouser</div></td>
<td align="left">æ˜¯å¦å…è®¸ç”¨æˆ·è¿›è¡Œæ–‡ä»¶çš„æŒ‚è½½ä¸å¸è½½åŠŸèƒ½</td>
<td align="left">å¦‚æœè¦ä¿æŠ¤æ–‡ä»¶ç³»ç»Ÿï¼Œæœ€å¥½ä¸è¦æä¾›ç”¨æˆ·è¿›è¡ŒæŒ‚è½½ä¸å¸è½½ï¼Œå¯ä»¥é€‰æ‹© nouser</td>
</tr>
<tr>
<td align="left">auto<div>noauto</div></td>
<td align="left">è¿™ä¸ª auto æŒ‡çš„æ˜¯ <code>mount -a</code> æ—¶ä¼šä¸ä¼šè¢«æŒ‚è½½çš„é¡¹ç›®</td>
<td align="left">å¦‚æœä¸éœ€è¦æŸä¸ªåˆ†åŒºéšæ—¶è¢«æŒ‚è½½ï¼Œå¯ä»¥è®¾ç½®ä¸º noauto<div>ä¾‹å¦‚ï¼š&#x2F;etc&#x2F;fstab&nbsp; auto</div></td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody></table>
<h2 id="b-æ€§èƒ½ä¼˜åŒ–-äº†è§£"><a href="#b-æ€§èƒ½ä¼˜åŒ–-äº†è§£" class="headerlink" title="b. æ€§èƒ½ä¼˜åŒ– (äº†è§£)"></a>b. æ€§èƒ½ä¼˜åŒ– (äº†è§£)</h2><table>
<thead>
<tr>
<th align="left">å‚æ•°</th>
<th align="left">æè¿°</th>
<th align="left"></th>
</tr>
</thead>
<tbody><tr>
<td align="left">rsize<div>wsize</div></td>
<td align="left">è®¾ç½®è¯»ï¼ˆrsizeï¼‰ä¸å†™å…¥ï¼ˆwsizeï¼‰çš„åŒºå—å¤§å°ï¼ˆblock sizeï¼‰</td>
<td align="left">è¿™ä¸ªå€¼å¯ä»¥å½±å“å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¼ è¾“æ•°æ®çš„ç¼“å†²å­˜å‚¨é‡ï¼Œä¸€èˆ¬æ¥è¯´å¦‚æœåœ¨å±€åŸŸç½‘å†…ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯éƒ½æœ‰è¶³å¤Ÿçš„å†…å­˜ï¼Œå¯ä»¥è®¾ç½®çš„å¤§ä¸€ç‚¹ï¼Œæ¯”å¦‚ 65535ï¼Œæå‡ç¼“å†²åŒºå¯æå‡ nfs æ–‡ä»¶ç³»ç»Ÿçš„ä¼ è¾“èƒ½åŠ›ï¼Œä½†è®¾ç½®çš„ä¸èƒ½å¤ªå¤§ï¼Œæœ€å¥½ä»¥ç½‘ç»œèƒ½å¤Ÿä¼ è¾“çš„æœ€å¤§å€¼ä¸ºé™</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody></table>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## rsize=131072,wsize=131072</span></span><br><span class="line">[root@web01 ~]# grep 192.168.1.40 /proc/mounts </span><br><span class="line">192.168.1.40:/data/rw /mnt nfs4 rw,relatime,vers=4.1,rsize=131072,wsize=131072,n168.1.20,local_lock=none,addr=192.168.1.40 0 0</span><br></pre></td></tr></table></figure>

<h2 id="c-å†…æ ¸å‚æ•°ä¼˜åŒ–"><a href="#c-å†…æ ¸å‚æ•°ä¼˜åŒ–" class="headerlink" title="c. å†…æ ¸å‚æ•°ä¼˜åŒ–"></a>c. å†…æ ¸å‚æ•°ä¼˜åŒ–</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@web01 ~]# <span class="built_in">cat</span> /proc/sys/net/core/rmem_max </span><br><span class="line">212992</span><br><span class="line">[root@web01 ~]# <span class="built_in">cat</span> /proc/sys/net/core/rmem_default </span><br><span class="line">212992</span><br><span class="line">[root@web01 ~]# <span class="built_in">cat</span> /proc/sys/net/core/wmem_default </span><br><span class="line">212992</span><br><span class="line">[root@web01 ~]# <span class="built_in">cat</span> /proc/sys/net/core/wmem_max </span><br><span class="line">212992</span><br></pre></td></tr></table></figure>

<ul>
<li>ä¸Šè¿°æ–‡ä»¶å¦‚ä½•ä¿®æ”¹å†…å®¹ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt;&gt;/etc/sysctl.conf&lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">net.core.wmem_default = 8388608</span></span><br><span class="line"><span class="string">net.core.rmem_default = 8388608</span></span><br><span class="line"><span class="string">net.core.rmem_max = 16777216</span></span><br><span class="line"><span class="string">net.core.wmem_max = 16777216</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##åŠ è½½é…ç½®æ–‡ä»¶</span></span><br><span class="line">sysctl -p</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="å…«ã€ä¼˜åŒ–å°ç»“"><a href="#å…«ã€ä¼˜åŒ–å°ç»“" class="headerlink" title="å…«ã€ä¼˜åŒ–å°ç»“"></a>å…«ã€ä¼˜åŒ–å°ç»“</h1><table>
<thead>
<tr>
<th align="left">å‚æ•°</th>
<th align="left">æè¿°</th>
<th align="left"></th>
</tr>
</thead>
<tbody><tr>
<td align="left">rsize<div>wsize</div></td>
<td align="left">è®¾ç½®è¯»ï¼ˆrsizeï¼‰ä¸å†™å…¥ï¼ˆwsizeï¼‰çš„åŒºå—å¤§å°ï¼ˆblock sizeï¼‰</td>
<td align="left">è¿™ä¸ªå€¼å¯ä»¥å½±å“å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¼ è¾“æ•°æ®çš„ç¼“å†²å­˜å‚¨é‡ï¼Œä¸€èˆ¬æ¥è¯´å¦‚æœåœ¨å±€åŸŸç½‘å†…ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯éƒ½æœ‰è¶³å¤Ÿçš„å†…å­˜ï¼Œå¯ä»¥è®¾ç½®çš„å¤§ä¸€ç‚¹ï¼Œæ¯”å¦‚ 65535ï¼Œæå‡ç¼“å†²åŒºå¯æå‡ nfs æ–‡ä»¶ç³»ç»Ÿçš„ä¼ è¾“èƒ½åŠ›ï¼Œä½†è®¾ç½®çš„ä¸èƒ½å¤ªå¤§ï¼Œæœ€å¥½ä»¥ç½‘ç»œèƒ½å¤Ÿä¼ è¾“çš„æœ€å¤§å€¼ä¸ºé™</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody></table>
<ul>
<li>æ·»åŠ ç¡¬ä»¶ï¼ˆæœ€ç®€å•ï¼‰ï¼šsas&#x2F;ssd ç¡¬ç›˜ï¼Œä¹°å¤šå—ç»„æˆ raidï¼Œåˆ¶ä½œ raid5 æˆ– raid10.</li>
<li>NFS æœåŠ¡å™¨ç«¯é…ç½®<ul>
<li>&#x2F;data xxxx&#x2F;24 (rw, sync, all_squash, anonuid&#x3D;65534, anongid&#x3D;65534)  xxxx&#x2F;24</li>
</ul>
</li>
<li>NFS å®¢æˆ·ç«¯æŒ‚è½½å‘½ä»¤ä¼˜åŒ–ï¼š<ul>
<li>mount -t nfs -o <span style="background:rgba(28, 210, 16, 0.55)">nosuid,noexec,nodev</span>,<span style="background:#40a9ff">noatime,nodiratime,rsize&#x3D;131072,wsize&#x3D;131072</span>  192.168.1.40&#x2F;24:&#x2F;data &#x2F;mnt</li>
</ul>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">nosuidï¼Œnoexecï¼Œnodevï¼šå®‰å…¨ç›¸å…³é€‰é¡¹</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">noatimeï¼Œnodiratimeï¼Œrsizeï¼Œwsizeï¼šæ€§èƒ½é€‰é¡¹</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#noatimeï¼Œnodiratimeï¼šæ—¶é—´ç›¸å…³</span></span></span><br><span class="line">1ã€å…³äºæ–‡ä»¶çš„å‡ ä¸ªæ—¶é—´</span><br><span class="line"></span><br><span class="line">æˆ‘ä»¬é€šè¿‡statå‘½ä»¤æŸ¥çœ‹æ–‡ä»¶çš„ä¿¡æ¯ï¼Œ</span><br><span class="line"></span><br><span class="line">[root@CentOS-6-5 /home]# stat a</span><br><span class="line">  File: `a</span><br><span class="line">  Size: 12552     	Blocks: 32         IO Block: 4096   regular file</span><br><span class="line">Device: 802h/2050d	Inode: 1177548     Links: 1</span><br><span class="line">Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)</span><br><span class="line">Access: 2019-10-23 16:54:55.259130660 +0800</span><br><span class="line">Modify: 2019-10-23 16:54:55.259130660 +0800</span><br><span class="line">Change: 2019-10-23 16:54:55.259130660 +0800</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å…¶ä¸­æœ‰ä¸‰ä¸ªæ—¶é—´ï¼Œ</span><br><span class="line">accessï¼šæ–‡ä»¶ä¸Šæ¬¡è¢«è¯»å–çš„æ—¶é—´ï¼Œæ–‡ä»¶è¢«è¯»å–ï¼Œæ‰§è¡Œï¼Œæ‰“å¼€éƒ½ä¼šè§¦å‘æ›´æ–°</span><br><span class="line">modifyï¼šæ–‡ä»¶ä¸Šæ¬¡è¢«ä¿®æ”¹çš„æ—¶é—´ï¼Œ</span><br><span class="line">changeï¼šæ–‡ä»¶ä¸Šæ¬¡æƒé™å±ä¸»è¢«ä¿®æ”¹çš„æ—¶é—´</span><br><span class="line"></span><br><span class="line">2ã€noatimeé€‰é¡¹</span><br><span class="line"></span><br><span class="line">å¯¹äºæ–‡ä»¶ç³»ç»Ÿï¼Œæœ‰æ—¶å€™ä¸ºäº†æä¾›æ€§èƒ½ï¼Œä¼šè®¾ç½®noatimeé€‰é¡¹ï¼Œè¿™ä¸ªé€‰é¡¹çš„æ„æ€æ˜¯ä¸æ›´æ–°æ–‡ä»¶çš„accessæ—¶é—´ã€‚æ‰€ä»¥åœ¨è¯»å–ã€æ‰“å¼€ã€æ‰§è¡Œæ–‡ä»¶æ—¶éƒ½ä¸ä¼šä¿®æ”¹ï¼Œè¿™åœ¨ä¸€å®šç¨‹åº¦ä¸Šå°±é™ä½äº†ç³»ç»Ÿçš„IOï¼Œå°¤å…¶æ˜¯å¯¹äºè¯»å–å±…å¤šçš„æœåŠ¡å™¨ã€‚</span><br><span class="line"></span><br><span class="line">æœªè®¾ç½®noatime</span><br><span class="line"></span><br><span class="line">[root@CentOS-6-5 /home]# mount | grep sda2</span><br><span class="line">/dev/sda2 on / type ext4 (rw)</span><br><span class="line">[root@CentOS-6-5 /home]# stat a</span><br><span class="line">  File: `a</span><br><span class="line">  Size: 6         	Blocks: 8          IO Block: 4096   regular file</span><br><span class="line">Device: 802h/2050d	Inode: 1177548     Links: 1</span><br><span class="line">Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)</span><br><span class="line">Access: 2019-10-23 16:54:55.259130660 +0800</span><br><span class="line">Modify: 2019-10-26 22:16:49.186557777 +0800</span><br><span class="line">Change: 2019-10-26 22:16:49.186557777 +0800</span><br><span class="line">[root@CentOS-6-5 /home]# cat a</span><br><span class="line">hello</span><br><span class="line">[root@CentOS-6-5 /home]# stat a</span><br><span class="line">  File: `a</span><br><span class="line">  Size: 6         	Blocks: 8          IO Block: 4096   regular file</span><br><span class="line">Device: 802h/2050d	Inode: 1177548     Links: 1</span><br><span class="line">Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)</span><br><span class="line">Access: 2019-10-26 22:25:14.722556455 +0800</span><br><span class="line">Modify: 2019-10-26 22:16:49.186557777 +0800</span><br><span class="line">Change: 2019-10-26 22:16:49.186557777 +0800</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">æ­¤æ—¶æ–‡ä»¶ç³»ç»Ÿæœªè®¾ç½®noatimeï¼Œè¯»å–æ–‡ä»¶åï¼Œæ–‡ä»¶çš„accessæ—¶é—´å‘ç”Ÿæ›´æ–°ã€‚</span><br><span class="line"></span><br><span class="line">ç°åœ¨æˆ‘ä»¬é€šè¿‡remountæ·»åŠ noatimeé€‰é¡¹ï¼Œ</span><br><span class="line"></span><br><span class="line">[root@CentOS-6-5 /home]# mount -o remount,noatime /dev/sda2</span><br><span class="line">[root@CentOS-6-5 /home]# mount  | grep sda2</span><br><span class="line">/dev/sda2 on / type ext4 (rw,noatime)</span><br><span class="line">[root@CentOS-6-5 /home]# stat a</span><br><span class="line">  File: `a</span><br><span class="line">  Size: 6         	Blocks: 8          IO Block: 4096   regular file</span><br><span class="line">Device: 802h/2050d	Inode: 1177548     Links: 1</span><br><span class="line">Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)</span><br><span class="line">Access: 2019-10-26 22:25:14.722556455 +0800</span><br><span class="line">Modify: 2019-10-26 22:16:49.186557777 +0800</span><br><span class="line">Change: 2019-10-26 22:16:49.186557777 +0800</span><br><span class="line">[root@CentOS-6-5 /home]# cat a</span><br><span class="line">hello</span><br><span class="line">[root@CentOS-6-5 /home]# stat a</span><br><span class="line">  File: `a</span><br><span class="line">  Size: 6         	Blocks: 8          IO Block: 4096   regular file</span><br><span class="line">Device: 802h/2050d	Inode: 1177548     Links: 1</span><br><span class="line">Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)</span><br><span class="line">Access: 2019-10-26 22:25:14.722556455 +0800</span><br><span class="line">Modify: 2019-10-26 22:16:49.186557777 +0800</span><br><span class="line">Change: 2019-10-26 22:16:49.186557777 +0800</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å¯è§ï¼Œæ·»åŠ noatimeåï¼Œæ‰§è¡ŒåŒæ ·çš„è¯»å–æ–‡ä»¶æ“ä½œï¼Œæ–‡ä»¶çš„accessæ—¶é—´å¹¶æ²¡æœ‰æ›´æ–°ï¼Œå› æ­¤å°±å¯ä»¥èŠ‚çº¦å¤§é‡çš„IOï¼Œæä¾›ç³»ç»Ÿæ€§èƒ½ã€‚</span><br><span class="line"></span><br><span class="line">3ã€nodiratimeé€‰é¡¹</span><br><span class="line"></span><br><span class="line">noatimeæ˜¯å¯¹äºæ–‡ä»¶è€Œè¨€ï¼Œé‚£å¯¹äºç›®å½•å‘¢ã€‚å…¶å®åœ¨linuxä¸Šï¼Œç›®å½•ä¹Ÿæ˜¯ä¸€ç§æ–‡ä»¶ï¼Œæ¯•ç«Ÿåœ¨ linuxä¸Ševerything is a fileã€‚å› æ­¤å½“è®¾ç½®noatimeæ—¶ï¼Œå¯¹äºç›®å½•ä¹Ÿæ˜¯ä¸€æ ·çš„æ•ˆæœã€‚å¦‚æœæƒ³è¦å•ç‹¬å¯¹ç›®å½•æœ‰æ­¤æ•ˆæœï¼Œå°±å¯ä»¥ä½¿ç”¨nodiratimeã€‚å› æ­¤noatimeè®¾ç½®åï¼Œå°±æ— éœ€å†è®¾ç½®nodiratimeã€‚</span><br></pre></td></tr></table></figure>

<ul>
<li>å¦‚æœ<span style="background:rgba(28, 210, 16, 0.55)">å¸è½½</span>çš„æ—¶å€™æç¤ºâ€œumount &#x2F;mnt: device is busyâ€<ul>
<li>éœ€è¦é€€å‡ºæŒ‚è½½ç›®å½•å†è¿›è¡Œå¸è½½</li>
<li>å¦‚æœæ˜¯ NFS æœåŠ¡ç«¯å®•æœºï¼Œéœ€è¦å¼ºåˆ¶å¸è½½ï¼Œ<code>umount -lf /mnt </code></li>
</ul>
</li>
<li>å¤§å‹ç½‘ç«™ NFS ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿçš„æ›¿ä»£è½¯ä»¶ä¸º&#x3D;&#x3D;åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ&#x3D;&#x3D;Moosefsï¼ˆMFSï¼‰ï¼ŒGlusterFS (å¤§æ–‡ä»¶)ã€FastDFS.</li>
</ul>
<h1 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h1><h2 id="1-é‡å¯åæ— æ•Œæ—¶é—´"><a href="#1-é‡å¯åæ— æ•Œæ—¶é—´" class="headerlink" title="1. é‡å¯åæ— æ•Œæ—¶é—´"></a>1. é‡å¯åæ— æ•Œæ—¶é—´</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åœ¨æˆ‘ä»¬ä½¿ç”¨restarté‡å¯nfsåï¼Œé»˜è®¤ä¼šæœ‰90ç§’çš„æ— æ•Œæ—¶é—´ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯æŒ‚è½½ä¼šå¡ä½æ— æ³•æ“ä½œ</span></span><br><span class="line"><span class="comment">## è§£å†³ï¼šä½¿ç”¨reloadåŠ è½½é…ç½®æ–‡ä»¶ï¼šsystemctl reload nfs</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æœåŠ¡ç«¯é‡å¯nfs</span></span><br><span class="line">[root@nfs01 ~]# systemctl restart nfs</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®¢æˆ·ç«¯è¿›è¡ŒæŒ‚è½½ä¼šå¤„äºç­‰å¾…çŠ¶æ€</span></span><br><span class="line">[root@web01 ~]# mount -t nfs 192.168.1.40:/data/ro /mnt/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@web01 ~]# </span><br></pre></td></tr></table></figure>

<p><img src="/images/202403291252635.png"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://mettafy.github.io">Metta</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://mettafy.github.io/2024/07/29/%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84/%E5%A4%87%E4%BB%BD%E4%B8%8E%E5%AD%98%E5%82%A8/02-NFS%E5%AD%98%E5%82%A8%E6%9C%8D%E5%8A%A1/">https://mettafy.github.io/2024/07/29/%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84/%E5%A4%87%E4%BB%BD%E4%B8%8E%E5%AD%98%E5%82%A8/02-NFS%E5%AD%98%E5%82%A8%E6%9C%8D%E5%8A%A1/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://mettafy.github.io" target="_blank">DevOps</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%96%87%E6%A1%A3/">æ–‡æ¡£</a><a class="post-meta__tags" href="/tags/%E5%9F%BA%E7%A1%80/">åŸºç¡€</a></div><div class="post_share"><div class="social-share" data-image="/img/touxiang.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/07/29/%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84/%E5%A4%87%E4%BB%BD%E4%B8%8E%E5%AD%98%E5%82%A8/01-Rsync%E5%A4%87%E4%BB%BD/" title="Rsyncå¤‡ä»½æœåŠ¡"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">Rsyncå¤‡ä»½æœåŠ¡</div></div></a></div><div class="next-post pull-right"><a href="/2024/07/29/%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84/%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/Openssh/" title="OpenSSHè¿œç¨‹æœåŠ¡"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">OpenSSHè¿œç¨‹æœåŠ¡</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/2024/07/29/Linux%E5%9F%BA%E7%A1%80/Linux%E5%9F%BA%E7%A1%80/" title="LinuxåŸºç¡€"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-30</div><div class="title">LinuxåŸºç¡€</div></div></a></div><div><a href="/2024/07/29/%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84/%E5%A4%87%E4%BB%BD%E4%B8%8E%E5%AD%98%E5%82%A8/01-Rsync%E5%A4%87%E4%BB%BD/" title="Rsyncå¤‡ä»½æœåŠ¡"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-30</div><div class="title">Rsyncå¤‡ä»½æœåŠ¡</div></div></a></div><div><a href="/2024/07/29/%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84/%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/Openssh/" title="OpenSSHè¿œç¨‹æœåŠ¡"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-30</div><div class="title">OpenSSHè¿œç¨‹æœåŠ¡</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/touxiang.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Metta</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">2</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Mettafy/mettafy.github.io"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81nfs-%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">ä¸€ã€nfs æ¦‚è¿°</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81nfs-%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">2.</span> <span class="toc-text">äºŒã€nfs çš„å·¥ä½œåŸç†</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%AE%9E%E6%88%98"><span class="toc-number">3.</span> <span class="toc-text">ä¸‰ã€å®æˆ˜</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%8F%82%E6%95%B0"><span class="toc-number">4.</span> <span class="toc-text">å››ã€æœåŠ¡ç«¯å‚æ•°</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%8C%82%E8%BD%BD%E5%8F%82%E6%95%B0"><span class="toc-number">5.</span> <span class="toc-text">äº”ã€å®¢æˆ·ç«¯æŒ‚è½½å‚æ•°</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AD%E3%80%81-NFS-%E5%AD%98%E5%82%A8%E5%B0%8F%E7%BB%93"><span class="toc-number">6.</span> <span class="toc-text">å…­ã€ NFS å­˜å‚¨å°ç»“</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-NFS-%E5%AD%98%E5%82%A8%E4%BC%98%E7%82%B9"><span class="toc-number">6.1.</span> <span class="toc-text">1. NFS å­˜å‚¨ä¼˜ç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-NFS-%E5%AD%98%E5%82%A8%E5%B1%80%E9%99%90"><span class="toc-number">6.2.</span> <span class="toc-text">2. NFS å­˜å‚¨å±€é™</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-NFS-%E5%BA%94%E7%94%A8%E5%BB%BA%E8%AE%AE"><span class="toc-number">6.3.</span> <span class="toc-text">3. NFS åº”ç”¨å»ºè®®</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E4%BC%98%E5%8C%96%E8%AE%BE%E7%BD%AE"><span class="toc-number">7.</span> <span class="toc-text">ä¸ƒã€ä¼˜åŒ–è®¾ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#a-%E5%AE%89%E5%85%A8%E4%BC%98%E5%8C%96-%EF%BC%88%E6%8E%8C%E6%8F%A1%EF%BC%89"><span class="toc-number">7.1.</span> <span class="toc-text">a.å®‰å…¨ä¼˜åŒ– ï¼ˆæŒæ¡ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#b-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-%E4%BA%86%E8%A7%A3"><span class="toc-number">7.2.</span> <span class="toc-text">b. æ€§èƒ½ä¼˜åŒ– (äº†è§£)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#c-%E5%86%85%E6%A0%B8%E5%8F%82%E6%95%B0%E4%BC%98%E5%8C%96"><span class="toc-number">7.3.</span> <span class="toc-text">c. å†…æ ¸å‚æ•°ä¼˜åŒ–</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E4%BC%98%E5%8C%96%E5%B0%8F%E7%BB%93"><span class="toc-number">8.</span> <span class="toc-text">å…«ã€ä¼˜åŒ–å°ç»“</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">9.</span> <span class="toc-text">æ³¨æ„äº‹é¡¹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E9%87%8D%E5%90%AF%E5%90%8E%E6%97%A0%E6%95%8C%E6%97%B6%E9%97%B4"><span class="toc-number">9.1.</span> <span class="toc-text">1. é‡å¯åæ— æ•Œæ—¶é—´</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/07/29/%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84/%E5%A4%87%E4%BB%BD%E4%B8%8E%E5%AD%98%E5%82%A8/01-Rsync%E5%A4%87%E4%BB%BD/" title="Rsyncå¤‡ä»½æœåŠ¡">Rsyncå¤‡ä»½æœåŠ¡</a><time datetime="2024-07-29T16:10:00.000Z" title="å‘è¡¨äº 2024-07-30 00:10:00">2024-07-30</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/07/29/%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84/%E5%A4%87%E4%BB%BD%E4%B8%8E%E5%AD%98%E5%82%A8/02-NFS%E5%AD%98%E5%82%A8%E6%9C%8D%E5%8A%A1/" title="NFSå­˜å‚¨">NFSå­˜å‚¨</a><time datetime="2024-07-29T16:10:00.000Z" title="å‘è¡¨äº 2024-07-30 00:10:00">2024-07-30</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/07/29/%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84/%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/Openssh/" title="OpenSSHè¿œç¨‹æœåŠ¡">OpenSSHè¿œç¨‹æœåŠ¡</a><time datetime="2024-07-29T16:00:20.000Z" title="å‘è¡¨äº 2024-07-30 00:00:20">2024-07-30</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/07/29/Linux%E5%9F%BA%E7%A1%80/Linux%E5%9F%BA%E7%A1%80/" title="LinuxåŸºç¡€">LinuxåŸºç¡€</a><time datetime="2024-07-29T16:00:00.000Z" title="å‘è¡¨äº 2024-07-30 00:00:00">2024-07-30</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="åšå®¢æ¡†æ¶ä¸ºHexo_v7.3.0" title=""><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="ä¸»é¢˜ç‰ˆæœ¬Butterfly_v4.13.0" title=""><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="æœ¬ç«™é¡¹ç›®ç”±Githubæ‰˜ç®¡" title=""><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a></p>';
    console.log('å·²æŒ‚è½½butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="/js/bottom.js"></script><!-- hexo injector body_end end --></body></html>